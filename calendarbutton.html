<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="robots" content="noindex,follow" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <title>Parabot Lenong Paguyuban</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
</head>


<body>
    <div class="wrapper">
        <div class="container text-left p-4">
            <h2 class="m-0 float-start">Parabot Lenong Paguyuban</h2>
            <div class="float-end">
            <a href="index.html" class="btn btn-outline-dark">back</a>
            </div>
            <div class="clearfix"></div>
        </div>
        <hr class="m-0">
        <div class="container pt-4">
            <h3>Add to Calendar Link Generator</h3>
            <form id="eventForm" class="mb-5">
              <div class="row">
                  <div class="col-md-12 col-xs-12">
                      <label for="title" class="form-label">Title: </label>
                      <input type="text" id="title" class="form-control" placeholder="isi judul event">
                  </div>
              </div>
              <div class="row mt-3">
                  <div class="col-md-12 col-xs-12">
                      <label for="description" class="form-label">Description: </label>
                      <textarea type="text" id="description" class="form-control" placeholder="isi deskripsi di sini"></textarea>                  
                  </div>
              </div>
              <div class="row mt-3">
                  <div class="col-md-12 col-xs-12">
                      <label for="location" class="form-label">Location: </label>
                      <input type="text" id="location" class="form-control" placeholder="isi lokasi">                   
                  </div>
              </div>
              <div class="row mt-3">
                  <div class="col-md-3 col-xs-6">
                      <label for="start" class="form-label">Start Time: </label>
                      <input type="datetime-local" class="form-control" id="start" required>
                  </div>
                  <div class="col-md-3 col-xs-6">
                      <label for="end" class="form-label">End Time: </label>
                      <input type="datetime-local" class="form-control"  id="end" required>
                  </div>
              </div>
              <div class="row mt-3">
                  <div class="col-md-12 col-xs-12">
                    <button type="submit" class="btn btn-outline-dark mt-4">Generate HTML Links</button>
                  </div>
              </div>
              <div class="row mt-3 mb-3">
                  <div class="col-md-12 col-xs-12">
                    <div class="output"  id="outputLinks"></div>
                  </div>
              </div> 
              
            </form>
        </div>
    </div>



<script>
    document.getElementById('eventForm').addEventListener('submit', function (e) {
      e.preventDefault();

      const title = encodeURIComponent(document.getElementById('title').value.trim());
      const description = encodeURIComponent(document.getElementById('description').value.trim());
      const location = encodeURIComponent(document.getElementById('location').value.trim());
      const start = new Date(document.getElementById('start').value);
      const end = new Date(document.getElementById('end').value);

      // Format date as YYYYMMDDTHHmmssZ for Google Calendar
      const formatGoogleDate = date => {
        return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
      };

      // Format date as ISO for Outlook
      const formatOutlookDate = date => {
        return date.toISOString();
      };

      const gStart = formatGoogleDate(start);
      const gEnd = formatGoogleDate(end);
      const oStart = formatOutlookDate(start);
      const oEnd = formatOutlookDate(end);

      const googleUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${title}&dates=${gStart}/${gEnd}&details=${description}&location=${location}`;
      const outlookUrl = `https://outlook.live.com/calendar/0/deeplink/compose?path=/calendar/action/compose&subject=${title}&body=${description}&startdt=${oStart}&enddt=${oEnd}&location=${location}`;

      const output = `
        <div class="row mt-3">
          <div class="col-md-12">
            <label class="form-label">Google Calendar Link HTML:</label>
            <textarea class="copy-code form-control" readonly>&lt;a href="${googleUrl}" target="_blank"&gt;Add to Google Calendar&lt;/a&gt;</textarea>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-md-12">
            <label class="form-label">Outlook Calendar Link HTML:</label>
            <textarea class="copy-code form-control" readonly>&lt;a href="${outlookUrl}" target="_blank"&gt;Add to Outlook Calendar&lt;/a&gt;</textarea>
          </div>
        </div>
      `;

      document.getElementById('outputLinks').innerHTML = output;
    });
  </script>


</body>
</html>
